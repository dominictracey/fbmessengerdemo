ACC.csvimport={TEXT_CSV_CONTENT_TYPE:"text/csv",APP_EXCEL_CONTENT_TYPE:"application/vnd.ms-excel",_autoload:[["changeFileUploadAppearance",0!=$(".js-file-upload").length],["bindImportCSVActions",0!=$(".js-import-csv").length]],changeFileUploadAppearance:function(){$(".js-file-upload__input").on("change",function(){$(".js-file-upload__file-name").text(this.value.toLowerCase().replace(/c:\\fakepath\\/g,"")),0<$(".js-file-upload").parents("#cboxLoadedContent").length&&ACC.colorbox.resize()})},bindImportCSVActions:function(){$("#chooseFileButton").on("click",function(e){ACC.csvimport.clearGlobalAlerts()}),$("#importButton").on("click",function(e){if(e.preventDefault(),ACC.csvimport.clearGlobalAlerts(),0<$(".js-file-upload__input").val().trim().length){var t=document.getElementById("csvFile").files[0];if(ACC.csvimport.isSelectedFileValid(t)){var l=document.getElementById("importCSVSavedCartForm"),s=new window.FormData(l);s.append("csvFile",t),ACC.csvimport.displayGlobalAlert({type:"warning",messageId:"import-csv-upload-message"}),ACC.csvimport.enableDisableActionButtons(!1),$.ajax({url:l.action,type:"POST",data:s,contentType:!1,processData:!1,success:function(){ACC.csvimport.displayGlobalAlert({type:"info",message:""}),$("#import-csv-alerts .alert-info").append($("#import-csv-success-message").html()),ACC.csvimport.clearChosenFile()},error:function(e){400==e.status&&e.responseJSON?ACC.csvimport.displayGlobalAlert({type:"error",message:e.responseJSON}):ACC.csvimport.displayGlobalAlert({type:"error",messageId:"import-csv-generic-error-message"})},complete:function(){ACC.csvimport.enableDisableActionButtons(!0)}})}}else ACC.csvimport.displayGlobalAlert({type:"error",messageId:"import-csv-no-file-chosen-error-message"})})},isSelectedFileValid:function(e){if(window.File&&window.Blob){if(e){if(e.type!=ACC.csvimport.TEXT_CSV_CONTENT_TYPE&&e.type!=ACC.csvimport.APP_EXCEL_CONTENT_TYPE)return ACC.csvimport.displayGlobalAlert({type:"error",messageId:"import-csv-file-csv-required"}),!1;var t=e.name;if(!t||!/\.csv$/i.test(t))return ACC.csvimport.displayGlobalAlert({type:"error",messageId:"import-csv-file-csv-required"}),!1}var l=$(".js-file-upload__input").data("file-max-size");if($.isNumeric(l)&&e&&e.size>parseFloat(l))return ACC.csvimport.displayGlobalAlert({type:"error",messageId:"import-csv-file-max-size-exceeded-error-message"}),!1}return!0},displayGlobalAlert:function(e){var t;switch(ACC.csvimport.clearGlobalAlerts(),e.type){case"error":t="#global-alert-danger-template";break;case"warning":t="#global-alert-warning-template";break;default:t="#global-alert-info-template"}void 0!==e.message&&$("#import-csv-alerts").append($(t).tmpl({message:e.message})),void 0!==e.messageId&&$("#import-csv-alerts").append($(t).tmpl({message:$("#"+e.messageId).text()}))},clearGlobalAlerts:function(){$("#import-csv-alerts").empty()},clearChosenFile:function(){document.getElementById("csvFile").value="",$(".js-file-upload__file-name").text("")},enableDisableActionButtons:function(e){$("#chooseFileButton").attr("disabled",!e),$("#importButton").prop("disabled",!e)}};
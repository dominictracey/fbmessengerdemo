ACC.quote={_autoload:[["bindAddComment",0!=$("#js-quote-comments").length],["bindAddEntryComment",0!=$(".js-quote-entry-comments").length],["toggleMoreComments",0!=$("#js-quote-comments").length],["toggleLessComments",0!=$("#js-quote-comments").length],["displayLessComments",0!=$("#js-quote-comments").length],["quoteDetailsNavigation",0!=$(".js-quote-actions").length],["bindQuoteButtons",0!=$(".js-btn-quote").length],["bindEditQuoteButton",0!=$(".js-quote-edit-btn").length],["bindSubmitConfirmation",0!=$(".js-quote-submit-btn").length],["bindCancelConfirmation",0!=$(".js-quote-cancel-btn").length],["bindName",0!=$("#js-quote-name").length],["bindDescription",0!=$("#js-quote-description").length],["bindExpirationTime",0!=$("#js-quote-expiration-time").length],["bindCheckoutConfirmation",0!=$(".js-quote-checkout-btn").length],["bindEditConfirmation",0!=$(".js-quote-warning-btn").length],["bindQuoteDiscount",0!=$(".js-quote-discount-link").length],["bindNewCartClick",0!=$(".new__cart--link").length]],bindEditQuoteButton:function(){$(".js-quote-edit-btn").on("click",function(){var t=$(this).data("quoteEditUrl");window.location=t})},bindNewCartClick:function(){$(".new__cart--link").bind("click",function(t){$(this).unbind(t)})},bindAddComment:function(){$(document).on("keypress","#js-quote-comments #comment",function(t){return 13!=t.keyCode||(""==$("#comment").val().trim()||(t.preventDefault(),ACC.quote.quoteCommentSubmit($("#comment").val()),$("#comment").val("")),!1)})},bindAddEntryComment:function(){$(document).on("keypress",".js-quote-entry-comments",function(t){return 13!=t.keyCode||(t.preventDefault(),ACC.quote.quoteEntryCommentSubmit($(this).val(),$(this).data("entry-number")),!1)})},bindQuoteButtons:function(){$(".js-save-quote-btn").click(function(){var t=$(this).data("saveQuoteUrl");$("#quoteForm").attr("action",t).submit()}),$(".js-submit-quote-btn").click(function(){var t=$(this).data("submitQuoteUrl");$("#quoteForm").attr("action",t).submit()}),$(".js-accept-quote-btn").click(function(){var t=$(this).data("acceptQuoteUrl");$("#quoteForm").attr("action",t).submit()})},quoteCommentSubmit:function(t){var o=$("#js-quote-comments"),e=o.data("quote-base-link")+"comment",n=o.data("show-all-comments");$.ajax({url:e,data:{comment:t},type:"post",success:function(t){ACC.quote.onCommentSuccess(n)}})},quoteEntryCommentSubmit:function(t,o){if(t&&t.length){var e=$("#js-quote-comments").data("quote-base-link")+"entry/comment";$.ajax({url:e,data:{comment:t,entryNumber:o},type:"post",success:function(){ACC.quote.onEntryCommentSuccess(o)}})}},onCommentSuccess:function(t){$("#commentListDiv").load(location.href+" #commentListDiv",function(){ACC.quote.displayComments(""+t)})},onEntryCommentSuccess:function(t){$("#entryCommentListDiv_"+t).load(location.href+" #entryCommentListDiv_"+t,function(){ACC.quote.displayEntryComments(t)}),$("#entryComment_"+t).val("")},toggleMoreComments:function(){$(document).on("click","#moreCommentsAnchor",ACC.quote.displayMoreComments),$(document).on("click",".js-more-entry-comments-anchor",ACC.quote.displayMoreEntryComments)},toggleLessComments:function(){$(document).on("click","#lessCommentsAnchor",ACC.quote.displayLessComments),$(document).on("click",".js-less-entry-comments-anchor",ACC.quote.displayLessEntryComments)},displayMoreComments:function(t){t.preventDefault(),ACC.quote.displayComments("true")},displayMoreEntryComments:function(t){t.preventDefault(),ACC.quote.displayEntryComments($(this).data("entry-number"),"true")},displayLessComments:function(t){null!=t&&t.preventDefault(),ACC.quote.displayComments("false")},displayLessEntryComments:function(t){t.preventDefault(),ACC.quote.displayEntryComments($(this).data("entry-number"),"false")},displayComments:function(t){for(var o=$("#js-quote-comments"),e=o.data("current-comments-shown"),n=$('[id^="comment_"]'),a=0;a<n.length;a++)"true"===t?$(n[a]).show():a<e?$(n[a]).show():$(n[a]).hide();return"false"===t?($("#moreCommentsAnchor").show(),$("#lessCommentsAnchor").hide(),o.data("show-all-comments",!1)):($("#moreCommentsAnchor").hide(),$("#lessCommentsAnchor").show(),o.data("show-all-comments",!0)),!1},displayEntryComments:function(t,o){var e=$("#entryCommentListDiv_"+t),n=e.find('[id^="entryComment_'+t+'"]');o=o||""+e.data("show-all-entry-comments");for(var a=0;a<n.length;a++)"true"===o?$(n[a]).show():a<4?$(n[a]).show():$(n[a]).hide();return"false"===o?(e.find(".js-more-entry-comments-anchor").show(),e.find(".js-less-entry-comments-anchor").hide(),e.data("show-all-entry-comments",!1)):(e.find(".js-more-entry-comments-anchor").hide(),e.find(".js-less-entry-comments-anchor").show(),e.data("show-all-entry-comments",!0)),!1},quoteDetailsNavigation:function(){$(".js-quote-actions").on("click",function(t){$(this).parent().find("nav").toggleClass("display-none")})},bindSubmitConfirmation:function(t){ACC.quote.handleConfirmationModal({actionButtonSelector:".js-quote-submit-btn",modalWindowSelector:"#js-quote-submit-modal",modalTitleDataAttributeName:"submit-confirmation-modal-title",cancelButtonSelector:"#js-quote-submit-modal #submitNoButton"}),$("#quoteSubmitForm").submit(function(t){var o=$("#quoteForm");if(o.is("form")){t.preventDefault();var e=$(this).prop("action");o.prop("action",e),o.submit()}})},bindCheckoutConfirmation:function(t){ACC.quote.handleConfirmationModal({actionButtonSelector:".js-quote-checkout-btn",modalWindowSelector:"#js-quote-checkout-modal",modalTitleDataAttributeName:"submit-confirmation-modal-title",cancelButtonSelector:"#js-quote-checkout-modal #submitNoButton"})},bindCancelConfirmation:function(t){ACC.quote.handleConfirmationModal({actionButtonSelector:".js-quote-cancel-btn",modalWindowSelector:"#js-quote-cancel-modal",modalTitleDataAttributeName:"cancel-confirmation-modal-title",cancelButtonSelector:"#js-quote-cancel-modal #cancelNoButton"})},bindEditConfirmation:function(t){ACC.quote.handleConfirmationModal({actionButtonSelector:".js-quote-warning-btn",modalWindowSelector:"#js-quote-edit-modal",modalTitleDataAttributeName:"edit-confirmation-modal-title",cancelButtonSelector:"#js-quote-edit-modal #cancelEditNoButton",confirmButtonSelector:"#js-quote-edit-modal #cancelEditYesButton"})},handleConfirmationModal:function(n){$(n.actionButtonSelector).click(function(t){t.preventDefault();var o=$(n.modalWindowSelector),e=o.data(n.modalTitleDataAttributeName);n.initializeCallback&&n.initializeCallback(),ACC.colorbox.open(e,{inline:!0,href:o,width:"480px",escKey:!1,overlayClose:!1,onComplete:function(){ACC.colorbox.resize()}})}),$(n.cancelButtonSelector).click(function(t){t.preventDefault(),ACC.colorbox.close()}),$(n.confirmButtonSelector).click(function(t){t.preventDefault(),ACC.colorbox.close();var o=$(n.actionButtonSelector).data("quoteEditUrl");window.location=o})},bindQuoteDiscount:function(t){ACC.quote.handleDiscountModal({actionButtonSelector:".js-quote-discount-link",modalWindowSelector:"#js-quote-discount-modal",modalTitleDataAttributeName:"quote-modal-title",modalTotalDataAttributeName:"quote-modal-total",modalQuoteDiscountDataAttributeName:"quote-modal-quote-discount",modalCurrencyDataAttributeName:"quote-modal-currency",cancelButtonSelector:"#js-quote-discount-modal #cancelButton"})},handleDiscountModal:function(e){var n=$(e.modalWindowSelector),a=parseFloat(n.data(e.modalTotalDataAttributeName)),i=parseFloat(n.data(e.modalQuoteDiscountDataAttributeName)),o=n.data(e.modalCurrencyDataAttributeName);function u(){$("#js-quote-discount-by-percentage").css("border-color","#cccccc"),$("#js-quote-discount-by-amount").css("border-color","#cccccc"),$("#js-quote-discount-adjust-total").css("border-color","#cccccc"),$("#submitButton").prop("disabled",!1)}function s(t){return isNaN(parseFloat(t))&&(t=(t=0).toFixed(2)),t}function t(){var t=parseFloat($("#js-quote-discount-by-percentage").val());100<t||t<0?($("#js-quote-discount-by-percentage").css("border-color","red"),$("#submitButton").prop("disabled",!0)):u();var o=(o=a*t/100).toFixed(2);$("#js-quote-discount-by-amount").val(s(o));var e=(e=a-o).toFixed(2);$("#js-quote-discount-adjust-total").val(s(e)),$("#js-quote-discount-rate").val(s(t)),$("#js-quote-discount-type").val("PERCENT"),d(e)}function c(){var t=$("#js-quote-discount-by-percentage").val(),o=$("#js-quote-discount-by-amount").val(),e=$("#js-quote-discount-adjust-total").val();""==t&&$("#js-quote-discount-by-percentage").val("0.00"),""==o&&$("#js-quote-discount-by-amount").val("0.00"),""!=e&&0!=e||$("#js-quote-discount-adjust-total").val(a)}function r(t){var o=$(this);46==t.which&&-1==o.val().indexOf(".")||!(t.which<48||57<t.which)||0==t.which||8==t.which||t.preventDefault();var e=$(this).val();46==t.which&&-1==e.indexOf(".")&&setTimeout(function(){3<o.val().substring(o.val().indexOf(".")).length&&o.val(o.val().substring(0,o.val().indexOf(".")+3))},1),-1!=e.indexOf(".")&&2<e.substring(e.indexOf(".")).length&&0!=t.which&&8!=t.which&&$(this)[0].selectionStart>=e.length-2&&t.preventDefault()}function l(){var t=parseFloat($("#js-quote-discount-by-amount").val());a<t||t<0?($("#js-quote-discount-by-amount").css("border-color","red"),$("#submitButton").prop("disabled",!0)):u();var o=(o=t/a*100).toFixed(2);$("#js-quote-discount-by-percentage").val(s(o));var e=(e=a-t).toFixed(2);$("#js-quote-discount-adjust-total").val(s(e)),$("#js-quote-discount-rate").val(s(t)),$("#js-quote-discount-type").val("ABSOLUTE"),d(e)}function m(){var t=parseFloat($("#js-quote-discount-adjust-total").val());a<t||t<0?($("#js-quote-discount-adjust-total").css("border-color","red"),$("#submitButton").prop("disabled",!0)):u();var o=(o=a-t).toFixed(2);$("#js-quote-discount-by-amount").val(s(o));var e=(e=o/a*100).toFixed(2);$("#js-quote-discount-by-percentage").val(s(e)),$("#js-quote-discount-rate").val(s(t)),$("#js-quote-discount-type").val("TARGET"),d(t)}function d(t){isNaN(parseFloat(t))&&(t=a);t=parseFloat(t).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,");$("#js-quote-discount-new-total").text(o.concat(t))}$(e.actionButtonSelector).click(function(t){t.preventDefault();var o=n.data(e.modalTitleDataAttributeName);e.initializeCallback&&e.initializeCallback(),ACC.colorbox.open(o,{inline:!0,href:n,width:"480px",onComplete:function(){ACC.colorbox.resize();var t=i/a*100,o=(a-i).toFixed(2);$("#js-quote-discount-by-percentage").val(t.toFixed(2)),$("#js-quote-discount-by-amount").val(i.toFixed(2)),$("#js-quote-discount-adjust-total").val(o)}})}),$(e.cancelButtonSelector).click(function(t){t.preventDefault(),ACC.colorbox.close()}),$("#js-quote-discount-by-percentage").keyup(t),$("#js-quote-discount-by-percentage").change(t),$("#js-quote-discount-by-percentage").blur(c),$("#js-quote-discount-by-percentage").keypress(r),$("#js-quote-discount-by-amount").keyup(l),$("#js-quote-discount-by-amount").focusout(l),$("#js-quote-discount-by-amount").keypress(r),$("#js-quote-discount-by-amount").blur(c),$("#js-quote-discount-adjust-total").keyup(m),$("#js-quote-discount-adjust-total").focusout(m),$("#js-quote-discount-adjust-total").keypress(r),$("#js-quote-discount-adjust-total").blur(c)},bindName:function(){$("#js-quote-name").on("focusout",function(){ACC.quote.updateMetadata()})},bindDescription:function(){$("#js-quote-description").on("focusout",function(){ACC.quote.updateMetadata()})},updateMetadata:function(){var t=$("#quoteFormDiv").data("metadata-url"),o=$("#js-quote-name").val().trim(),e=$("#js-quote-description").val(),n=$("#js-quote-name-wrapper");o&&o.length?(n.removeClass("has-error"),$.ajax({url:t,data:{name:o,description:e},type:"POST",success:function(){$(".js-modal-quote-description").text(e),$(".js-modal-quote-name").text(o)}})):n.hasClass("has-error")||n.addClass("has-error")},bindExpirationTime:function(t){var o=$("#js-quote-expiration-time"),e=o.data("date-format-for-date-picker"),n=o.data("min-offer-validity-period-days"),a=new Date;a.setDate(a.getDate()+n),$("#expirationTime").datepicker({dateFormat:e,constrainInput:!0,minDate:a,onSelect:function(){ACC.quote.handleExpirationTimeUpdate(o,e,n)}}),$("#expirationTime").change(function(){ACC.quote.handleExpirationTimeUpdate(o,e,n)}),$(document).on("click",".js-open-datepicker-quote-expiration-time",function(){$("#expirationTime").datepicker("show")})},handleExpirationTimeUpdate:function(t,o,e){var n=$("#expirationTime").val();ACC.quote.validateExpirationTime(o,n,e)?(ACC.quote.updateExpirationTime(n.trim()),t.removeClass("has-error")):t.hasClass("has-error")||t.addClass("has-error")},validateExpirationTime:function(t,o,e){try{if(o){var n=$.datepicker.parseDate(t,o),a=new Date;return a.setHours(0,0,0,0),a.setDate(a.getDate()+e),a<=n}return!0}catch(t){return!1}},updateExpirationTime:function(t){var o=$("#js-quote-expiration-time").data("expiration-time-url");$.ajax({url:o,type:"POST",data:{expirationTime:t},error:function(t){var o=$("#js-quote-expiration-time");o.hasClass("has-error")||o.addClass("has-error")}})}};
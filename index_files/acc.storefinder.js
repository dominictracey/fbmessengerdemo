ACC.storefinder={_autoload:[["init",0!=$(".js-store-finder").length],["bindStoreChange",0!=$(".js-store-finder").length],["bindSearch",0!=$(".js-store-finder").length],"bindPagination"],storeData:"",storeId:"",coords:{},storeSearchData:{},createListItemHtml:function(e,t){var r="";return r+='<li class="list__entry">',r+='<input type="radio" name="storeNamePost" value="'+e.displayName+'" id="store-filder-entry-'+t+'" class="js-store-finder-input" data-id="'+t+'">',r+='<label for="store-filder-entry-'+t+'" class="js-select-store-label">',r+='<span class="entry__info">',r+='<span class="entry__name">'+e.displayName+"</span>",r+='<span class="entry__address">'+e.line1+" "+e.line2+"</span>",r+='<span class="entry__city">'+e.town+"</span>",r+="</span>",r+='<span class="entry__distance">',r+="<span>"+e.formattedDistance+"</span>",r+="</span>",r+="</label>",r+="</li>"},refreshNavigation:function(){var e="";if(data=ACC.storefinder.storeData,data){for(i=0;i<data.data.length;i++)e+=ACC.storefinder.createListItemHtml(data.data[i],i);$(".js-store-finder-navigation-list").html(e);var t=$(".js-store-finder-input")[0];$(t).click()}var r=ACC.storefinder.storeSearchData.page;$(".js-store-finder-pager-item-from").html(10*r+1);var a=10*r+10>ACC.storefinder.storeData.total?ACC.storefinder.storeData.total:10*r+10;$(".js-store-finder-pager-item-to").html(a),$(".js-store-finder-pager-item-all").html(ACC.storefinder.storeData.total),$(".js-store-finder").removeClass("show-store")},bindPagination:function(){function r(e){0==e?$(".js-store-finder-pager-prev").attr("disabled","disabled"):$(".js-store-finder-pager-prev").removeAttr("disabled"),e==Math.floor(ACC.storefinder.storeData.total/10)?$(".js-store-finder-pager-next").attr("disabled","disabled"):$(".js-store-finder-pager-next").removeAttr("disabled")}$(document).on("click",".js-store-finder-details-back",function(e){e.preventDefault(),$(".js-store-finder").removeClass("show-store")}),$(document).on("click",".js-store-finder-pager-prev",function(e){e.preventDefault();var t=ACC.storefinder.storeSearchData.page;ACC.storefinder.getStoreData(t-1),r(t-1)}),$(document).on("click",".js-store-finder-pager-next",function(e){e.preventDefault();var t=ACC.storefinder.storeSearchData.page;ACC.storefinder.getStoreData(t+1),r(t+1)})},bindStoreChange:function(){$(document).on("change",".js-store-finder-input",function(e){e.preventDefault(),storeData=ACC.storefinder.storeData.data;var t=$(this).data("id"),s=$(".js-store-finder-details");$.each(storeData[t],function(e,t){if("image"==e)""!=t?s.find(".js-store-image").html('<img src="'+t+'" alt="" />'):s.find(".js-store-image").html("");else if("productcode"==e)s.find(".js-store-productcode").val(t);else if("openings"==e)if(""!=t){var r=s.find(".js-store-"+e),a="";$.each(t,function(e,t){a+="<dt>"+e+"</dt>",a+="<dd>"+t+"</dd>"}),r.html(a)}else s.find(".js-store-"+e).html("");else if("specialOpenings"==e);else if("features"==e){var o="";$.each(t,function(e,t){o+="<li>"+t+"</li>"}),s.find(".js-store-"+e).html(o)}else""!=t?s.find(".js-store-"+e).html(t):s.find(".js-store-"+e).html("")}),ACC.storefinder.storeId=storeData[t],ACC.storefinder.initGoogleMap()}),$(document).on("click",".js-select-store-label",function(e){$(".js-store-finder").addClass("show-store")}),$(document).on("click",".js-back-to-storelist",function(e){$(".js-store-finder").removeClass("show-store")})},initGoogleMap:function(){0<$(".js-store-finder-map").length&&ACC.global.addGoogleMapsApi("ACC.storefinder.loadGoogleMap")},loadGoogleMap:function(){if(storeInformation=ACC.storefinder.storeId,0<$(".js-store-finder-map").length){$(".js-store-finder-map").attr("id","store-finder-map");var e=new google.maps.LatLng(storeInformation.latitude,storeInformation.longitude),t={zoom:13,zoomControl:!0,panControl:!0,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,center:e},r=new google.maps.Map(document.getElementById("store-finder-map"),t),a=new google.maps.Marker({position:new google.maps.LatLng(storeInformation.latitude,storeInformation.longitude),map:r,title:storeInformation.name,icon:"https://maps.google.com/mapfiles/markerA.png"}),o=new google.maps.InfoWindow({content:storeInformation.name,disableAutoPan:!0});google.maps.event.addListener(a,"click",function(){o.open(r,a)})}},bindSearch:function(){$(document).on("submit","#storeFinderForm",function(e){e.preventDefault();var t=$(".js-store-finder-search-input").val();if(0<t.length)ACC.storefinder.getInitStoreData(t);else if($(".js-storefinder-alert").length<1){var r=$(".btn-primary").data("searchEmpty");$(".js-store-finder").hide(),$("#storeFinder").before('<div class="js-storefinder-alert alert alert-danger alert-dismissable" ><button class="close" type="button" data-dismiss="alert" aria-hidden="true">Ã—</button>'+r+"</div>")}}),$(".js-store-finder").hide(),$(document).on("click","#findStoresNearMe",function(e){e.preventDefault(),ACC.storefinder.getInitStoreData(null,ACC.storefinder.coords.latitude,ACC.storefinder.coords.longitude)})},getStoreData:function(e){ACC.storefinder.storeSearchData.page=e,url=$(".js-store-finder").data("url"),$.ajax({url:url,data:ACC.storefinder.storeSearchData,type:"get",success:function(e){ACC.storefinder.storeData=$.parseJSON(e),ACC.storefinder.refreshNavigation(),ACC.storefinder.storeData.total<10&&$(".js-store-finder-pager-next").attr("disabled","disabled")}})},getInitStoreData:function(e,t,r){$(".alert").remove(),data={q:"",page:0},null!=e&&(data.q=e),null!=t&&(data.latitude=t),null!=r&&(data.longitude=r),ACC.storefinder.storeSearchData=data,ACC.storefinder.getStoreData(data.page),$(".js-store-finder").show(),$(".js-store-finder-pager-prev").attr("disabled","disabled"),$(".js-store-finder-pager-next").removeAttr("disabled")},init:function(){$("#findStoresNearMe").attr("disabled","disabled"),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){ACC.storefinder.coords=e.coords,$("#findStoresNearMe").removeAttr("disabled")},function(e){console.log("An error occurred... The error code and message are: "+e.code+"/"+e.message)})}};